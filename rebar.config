{erl_opts, [debug_info]}.

{deps, [
    {proper, "1.4.0"}
]}.

%% Test directories configuration
{eunit_compile_opts, [debug_info]}.
%% Note: Only list leaf directories to avoid duplicate module compilation
{extra_src_dirs, [
    "test",
    "test/compiler/lexer",
    "test/compiler/parser",
    "test/compiler/types",
    "test/compiler/error",
    "test/compiler/ast",
    "test/compiler/codegen",
    "test/compiler/runtime",
    "test/compiler/integration",
    "test/compiler/semantic",
    "test/integration"
]}.
{eunit_exclude_mods, [analyze_conflicts, location_tracking_demo, resource_limits_demo]}.

{plugins, [
    rebar3_proper
]}.

%% Dialyzer configuration
{dialyzer, [
    {warnings, [
        unmatched_returns,
        error_handling,
        underspecs,
        unknown
    ]},
    {plt_apps, top_level_deps},
    {plt_extra_apps, [compiler, syntax_tools]},
    %% Exclude generated modules from analysis
    {exclude_mods, [
        catena_lexer,
        catena_parser
    ]}
]}.

%% Pre-compile hooks for lexer and parser generation
{pre_hooks, [
    {compile, "scripts/build.sh"}
]}.

{eunit_opts, [verbose]}.

{cover_enabled, true}.
{cover_opts, [verbose]}.

%% Coverage export configuration
{cover_export_enabled, true}.
{cover_excl_mods, [
    % Exclude generated modules from coverage
    catena_lexer_gen,
    catena_parser
]}.

%% PropEr configuration
{proper_opts, [
    {numtests, 100},        % Number of test cases per property
    {max_size, 20},         % Maximum size for generated data
    verbose,                 % Show progress
    {start_size, 1}         % Start with small test cases
]}.
